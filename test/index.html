<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>测试页面</title>
    <script src="/test/jquery-1.8.3.min.js"></script>

    <script type="text/javascript" src="http://api.map.baidu.com/api?v=3.0&ak=iwfYuKQm6uTZzuFUneI7KMKhlT6IF6mi">
    </script>
    </script>

    <!-- 加载百度地图样式信息窗口 -->
    <link rel="stylesheet" href="http://api.map.baidu.com/library/SearchInfoWindow/1.5/src/SearchInfoWindow_min.css" />
    <style>
        html,
        body {
            width: 100%;
            height: 100%;
        }
    </style>
</head>

<body style="position: relative;">
    <div style="position:absolute;top: 0;left: 0;z-index: 999;">
        <button id="test1">默认轮流展示</button>
        <button id="test2">根据id切换展示</button>
        <button id="test3">全部展示</button>
        <button id="test4">全部隐藏</button>
    </div>

    <div style="width:100%; height:100%;" id="map"></div>

    <script>
        // 百度地图API功能
        var map = new BMap.Map("map", {
            enableMapClick: false
        }); // 创建Map实例

        // map.centerAndZoom("顺德", 12);
        map.centerAndZoom(new BMap.Point(113.300251, 22.810862), 13);

        map.setMapStyle({
            styleId: '75e6bbd3eb890ad0d54760c200146b9d'
        })

        var mapData = new MapData(map)
        map.enableScrollWheelZoom(true); //开启鼠标滚轮缩放
        $.ajax({
            url: 'http://localhost:8080/lapi/data1',
            success: function (res) {

                var example1 = mapData.createDraw('point', res, 'cheche')

                example1.click(function (item, map) {
                    var point = new BMap.Point(item.lon, item.lat);
                    var marker = new BMap.Marker(point);
                    $.ajax({
                        url: 'http://localhost:8080/mapi/clickData?id=' + item.id,
                        type: 'get',
                        success: function (res) {
                            var sContent = res.data.data;
                            var infoWindow = new BMap.InfoWindow(sContent); // 创建信息窗口对象
                            map.openInfoWindow(infoWindow, point); //开启信息窗口
                        }
                    })
                })
                // example1.icon("https://s1.ax1x.com/2020/04/17/JZku8K.png")
                example1.icon({url:"https://s1.ax1x.com/2020/05/07/YZmOu4.png"})
                mapData.render(example1)

            }
        })
        $.ajax({
            url: 'http://localhost:8080/lapi/data2',
            success: function (res) {

                // var example2 = mapData.createDraw('polygon', res, 'zoom')
                // example2.style({
                //     color: 'blue',
                //     width: 5
                // })
                // example2.zoom(function(map) {
                //     var ZoomNum = map.getZoom();
                //     if (ZoomNum < 13) {
                //         mapData.cache.forEach(function(item) {
                //             if (item.id == 'zoom') {
                //                 item.canvas.style.display = 'none' 
                //             }
                //         })
                //     } else {
                //         mapData.cache.forEach(function(item) {
                //             if (item.id == 'zoom') {
                //                 item.canvas.style.display = '' 
                //             }
                //         })
                //     }
                // })
              
                // mapData.render(example2)

                // var example3 = mapData.createDraw('point', res, 'wocao')
                // example3.click(function (item, map) {

                    // var point = new BMap.Point(item.lon, item.lat);
                    // var marker = new BMap.Marker(point);
                    // $.ajax({
                    //     url: 'http://localhost:8080/mapi/clickData?id=' + item.id,
                    //     type: 'get',
                    //     success: function (res) {
                    //         var sContent = res.data.data;
                    //         var infoWindow = new BMap.InfoWindow(sContent); // 创建信息窗口对象
                    //         map.openInfoWindow(infoWindow, point); //开启信息窗口
                    //     }
                    // })
                    // console.log('点击2')

                // })
                // example3.icon(
                //     {url:"https://s1.ax1x.com/2020/05/07/YZnivD.png",
                //     width:24,
                //     height:33      
                // })
                // mapData.render(example3)
            }
        })

        $("#test1").click(function () {
            mapData.switchCanvas()
        })
        $("#test2").click(function () {
            mapData.swidthCanvasById('cheche')
        })
        $("#test3").click(function () {
            mapData.allCanvasShow()
        })
        $("#test4").click(function () {
            mapData.allCanvasHide()
        })
    </script>
</body>

</html>